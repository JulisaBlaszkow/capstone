
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>


</head>
<body>
<h1 id="hello"> hello</h1>
<canvas id="myChart"></canvas>
<!--<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.2.1/chart.umd.js"></script>

<!--<script  src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.min.js"></script>-->
<script  src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>

</body>
</html>



<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.2.1/chart.min.js"-->
<!--        integrity="sha512-v3ygConQmvH0QehvQa6gSvTE2VdBZ6wkLOlmK7Mcy2mZ0ZF9saNbbk19QeaoTHdWIEiTlWmrwAL4hS8ElnGFbA=="-->
<!--        crossorigin="anonymous" referrerpolicy="no-referrer"></script>-->

<!--<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>-->

<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.2.1/chart.min.js" integrity="sha512-v3ygConQmvH0QehvQa6gSvTE2VdBZ6wkLOlmK7Mcy2mZ0ZF9saNbbk19QeaoTHdWIEiTlWmrwAL4hS8ElnGFbA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>-->

<!--<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon"></script>-->

<!--<script src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.min.js"></script>-->
<!--<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>-->



<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.2.1/chart.min.js" integrity="sha512-v3ygConQmvH0QehvQa6gSvTE2VdBZ6wkLOlmK7Mcy2mZ0ZF9saNbbk19QeaoTHdWIEiTlWmrwAL4hS8ElnGFbA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>-->
<!--    <script>-->
<!--        const element = document.getElementById('hello');-->
<!--        setInterval(function () {console.log("hello")}, 1000);-->
<!--    </script>-->
<script>


    const ctx = document.getElementById('myChart');
    // const response = await fetch("http://localhost:3000/data");
    // const json = await response.json();
    // const response = {};
   // const json = {};
    // const generatelabels = (json) =>{
    //     return json.map(row => row.x)
    // };
    // const generatedata = (json) =>{
    //     return json.map(row => row.y)
    // };

    let data = {
        labels:{},
            datasets: [{
            label: 'y',
            data: {}
        }
        ]
    }
    const config = {
        type: 'line',
        data: data,
        options: {
            scales: {
                x: {
                    type: 'time',
                }
            },
            // animation: false,
            // scaleOverride: true,
            // scaleSteps: 10,
            // scaleStartValue: 0
        }
    };

   // let chart = null;
    let chart = new Chart(ctx, config);





    setInterval(async function () {
        // if (chart != null) {
        //     chart.destroy();
        // }
        chart.destroy();
        const response = await fetch("http://localhost:3000/data");
        //const json = await response.json();
        const json = await response.json();

        chart.data.datasets.forEach(dataset => {
            dataset.data = json.map(row => row.y);
            console.log("hiii"+(json.map(row => row.y)));
            //dataset.data.shift();

        });

        chart.data.labels = (json.map(row => row.x));
        console.log("hi"+(json.map(row => row.x)));
        //chart.data.labels.shift();

        chart = new Chart(ctx, config);

        //patienceeee
   }, 3000);
</script>